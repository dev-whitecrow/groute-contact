<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Share Travel Blog</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000000;
            height: 100vh;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <script>
        // 운영체제 감지 함수
        function detectOS() {
            const userAgent = navigator.userAgent || navigator.vendor || window.opera;
            
            // iOS 감지
            if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
                return 'ios';
            }
            
            // Android 감지
            if (/android/i.test(userAgent)) {
                return 'android';
            }
            
            // 기타
            return 'others';
        }

        // 네이티브 공유 함수
        async function triggerNativeShare() {
            const targetUrl = 'https://tally.so/r/wQP90A?utm_medium=referral_share';
            const shareData = {
                title: 'You travel. Your first draft is already waiting.',
                text: 'You are a creator, not a content manager. No more chores. Just creation.',
                url: targetUrl
            };

            const os = detectOS();
            
            try {
                // Web Share API 지원 확인 (주로 모바일)
                if (navigator.share && (os === 'ios' || os === 'android')) {
                    await navigator.share(shareData);
                } else {
                    // Web Share API 미지원시 fallback
                    handleFallbackShare(targetUrl, os);
                }
            } catch (error) {
                console.log('Share cancelled or failed:', error);
                // 공유 취소 또는 실패시 원본 링크로 리다이렉트
                window.location.href = targetUrl;
            }
        }

        // Fallback 공유 처리
        function handleFallbackShare(url, os) {
            if (os === 'ios') {
                // iOS Safari에서 Web Share API 미지원시
                if (navigator.userAgent.includes('Safari') && !navigator.userAgent.includes('Chrome')) {
                    // Safari 공유 시트 트리거 시도
                    const shareUrl = `data:text/plain;charset=utf-8,${encodeURIComponent('You travel. Your first draft is already waiting: ' + url)}`;
                    const link = document.createElement('a');
                    link.href = shareUrl;
                    link.download = 'share.txt';
                    link.click();
                }
            } else if (os === 'android') {
                // Android Chrome에서 Web Share API 미지원시
                if ('share' in navigator) {
                    navigator.share({
                        title: 'You travel. Your first draft is already waiting.',
                        url: url
                    });
                } else {
                    // Intent URL 사용
                    const intentUrl = `intent://send?text=${encodeURIComponent('You travel. Your first draft is already waiting: ' + url)}#Intent;scheme=https;package=com.android.chrome;end`;
                    window.location.href = intentUrl;
                }
            }
            
            // 모든 fallback 실패시 원본 링크로 이동
            setTimeout(() => {
                window.location.href = url;
            }, 1000);
        }

        // 페이지 로드 즉시 공유 트리거
        window.addEventListener('load', function() {
            // 약간의 지연을 두어 페이지가 완전히 로드된 후 실행
            setTimeout(triggerNativeShare, 100);
        });

        // DOMContentLoaded 이벤트로도 백업 실행
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(triggerNativeShare, 100);
        });
    </script>
</body>
</html>
